<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8"/>
    <title>Enable 2-Factor Authentication</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@4.3.1/dist/css/bootstrap.min.css" rel="stylesheet"/>
</head>
<body class="p-4">

<div class="container">
    <h2>Enable Two-Factor Authentication</h2>
    <p>Scan this QR code in your Authenticator app:</p>
    <img th:src="${qrUrl}" alt="QR code for TOTP" class="mb-3"/>

    <form th:action="@{/auth/basic/2fa/setup}" method="post" class="form-inline">
        <div class="form-group mb-2">
            <label for="code" class="sr-only">Code</label>
            <input
                    type="text"
                    id="code"
                    name="code"
                    class="form-control"
                    placeholder="123456"
                    required
                    pattern="[0-9]{6}"
                    inputmode="numeric"
            />
        </div>
        <button class="btn btn-primary mb-2 ml-2">Confirm & Enable</button>
    </form>

    <div th:if="${param.error}" class="alert alert-danger mt-3">
        Invalid code, please try again.
    </div>

    <a th:href="@{/auth/basic/home}" class="btn btn-link mt-3">Back to Home</a>
</div>

</body>
</html>
